<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Software Documentation: Megasoft TMS</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            background-color: #f8f9fa;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        h1, h2, h3 {
            color: #1a237e;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-top: 40px;
            margin-bottom: 20px;
        }
        h1 {
            text-align: center;
            font-size: 2.5em;
            border-bottom: 4px solid #3f51b5;
        }
        h2 { font-size: 2em; }
        h3 { font-size: 1.5em; border-bottom: 1px solid #e0e0e0;}

        /* Table of Contents */
        .toc {
            background-color: #e8eaf6;
            border-left: 5px solid #3f51b5;
            padding: 15px 20px;
            margin: 30px 0;
            border-radius: 5px;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        .toc li {
            margin: 8px 0;
        }
        .toc a {
            text-decoration: none;
            color: #303f9f;
            font-weight: bold;
        }
        .toc a:hover {
            text-decoration: underline;
        }
        .toc .sub-list {
            padding-left: 20px;
            font-weight: normal;
        }
        .toc .sub-list a {
            font-weight: normal;
        }

        /* Code Blocks */
        pre {
            background-color: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 8px;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: "Courier New", Courier, monospace;
            font-size: 14px;
        }
        code {
            font-family: "Courier New", Courier, monospace;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3f51b5;
            color: white;
            font-weight: bold;
        }
        td:first-child {
            font-weight: bold;
            background-color: #f5f5f5;
        }
        .title-table td:first-child {
            width: 150px;
        }

        /* Misc */
        .note {
            background-color: #fff9c4;
            border-left: 5px solid #fbc02d;
            padding: 10px 15px;
            margin: 20px 0;
        }
    </style>
</head>
<body>

    <div class="container">

        <h1>Software Design Documentation</h1>

        <table class="title-table">
            <tr>
                <td>Project Name:</td>
                <td>Megasoft Training Management System (TMS)</td>
            </tr>
            <tr>
                <td>Author:</td>
                <td>Kyrellos El Naggar</td>
            </tr>
            <tr>
                <td>Version:</td>
                <td>1.0</td>
            </tr>
            <tr>
                <td>Date:</td>
                <td>August 5, 2025</td>
            </tr>
        </table>

        <hr>

        <nav class="toc">
            <h2>Table of Contents</h2>
            <ul>
                <li><a href="#section_1">1. Introduction</a>
                    <ul class="sub-list">
                        <li><a href="#section_1_1">1.1. Project Purpose & Scope</a></li>
                        <li><a href="#section_1_2">1.2. Problem Statement</a></li>
                        <li><a href="#section_1_3">1.3. Intended Audience</a></li>
                    </ul>
                </li>
                <li><a href="#section_2">2. System Overview</a>
                    <ul class="sub-list">
                        <li><a href="#section_2_1">2.1. Key Features & Functionality</a></li>
                        <li><a href="#section_2_2">2.2. System Architecture</a></li>
                        <li><a href="#section_2_3">2.3. Technology Stack</a></li>
                    </ul>
                </li>
                <li><a href="#section_3">3. Installation & Setup Guide</a>
                    <ul class="sub-list">
                        <li><a href="#section_3_1">3.1. Prerequisites</a></li>
                        <li><a href="#section_3_2">3.2. Database Setup</a></li>
                        <li><a href="#section_3_3">3.3. Application Configuration</a></li>
                        <li><a href="#section_3_4">3.4. Building and Running</a></li>
                    </ul>
                </li>
                <li><a href="#section_4">4. User Guide</a>
                    <ul class="sub-list">
                        <li><a href="#section_4_1">4.1. Getting Started: Login</a></li>
                        <li><a href="#section_4_2">4.2. Main Dashboard Navigation</a></li>
                        <li><a href="#section_4_3">4.3. Student Management</a></li>
                        <li><a href="#section_4_4">4.4. Course Management</a></li>
                        <li><a href="#section_4_5">4.5. Score Management</a></li>
                    </ul>
                </li>
                <li><a href="#section_5">5. Code Documentation (Developer Guide)</a>
                    <ul class="sub-list">
                        <li><a href="#section_5_1">5.1. Project File Structure</a></li>
                        <li><a href="#section_5_2">5.2. Core Components Analysis</a></li>
                        <li><a href="#section_5_3">5.3. UI Forms Analysis</a></li>
                    </ul>
                </li>
                <li><a href="#section_6">6. Database Schema</a>
                    <ul class="sub-list">
                        <li><a href="#section_6_1">6.1. Entity-Relationship Diagram (ERD)</a></li>
                        <li><a href="#section_6_2">6.2. SQL Table Creation Scripts</a></li>
                    </ul>
                </li>
                <li><a href="#section_7">7. Appendices</a>
                    <ul class="sub-list">
                        <li><a href="#section_7_1">7.1. External Dependencies & APIs</a></li>
                        <li><a href="#section_7_2">7.2. Troubleshooting</a></li>
                    </ul>
                </li>
            </ul>
        </nav>

        <main>
            <section id="section_1">
                <h2>1. Introduction</h2>
                <h3 id="section_1_1">1.1. Project Purpose & Scope</h3>
                <p>Megasoft TMS is a comprehensive desktop application designed to streamline the administrative tasks of a training or educational center. The system provides a centralized platform for managing student information, course catalogs, and academic scores. The scope of the project includes full data management (Create, Read, Update, Delete), data filtering, and the generation of printable and PDF reports.</p>
                
                <h3 id="section_1_2">1.2. Problem Statement</h3>
                <p>Educational institutions often rely on manual or disparate systems for managing records, which can be inefficient, prone to human error, and time-consuming. Megasoft TMS solves this by providing a single, robust, and user-friendly digital solution to handle all core administrative data, thereby increasing efficiency and data accuracy.</p>
                
                <h3 id="section_1_3">1.3. Intended Audience</h3>
                <p>This document is intended for:</p>
                <ul>
                    <li><b>Project Stakeholders & Evaluators:</b> To understand the system's capabilities, architecture, and features.</li>
                    <li><b>System Administrators & End-Users:</b> To learn how to install, configure, and use the application.</li>
                    <li><b>Developers:</b> To understand the codebase, architecture, and database schema for maintenance and future development.</li>
                </ul>
            </section>
            
            <section id="section_2">
                <h2>2. System Overview</h2>
                <h3 id="section_2_1">2.1. Key Features & Functionality</h3>
                <ul>
                    <li><b>Secure Login:</b> The application is secured by a user authentication system.</li>
                    <li><b>Student Management:</b> Full CRUD (Create, Read, Update, Delete) functionality for student records.</li>
                    <li><b>Course Management:</b> A dedicated module for adding, editing, and managing the course catalog.</li>
                    <li><b>Score Management:</b> Functionality to assign, update, and manage student scores for various courses.</li>
                    <li><b>Advanced Reporting:</b>
                        <ul>
                            <li>Powerful search and filtering capabilities across all modules.</li>
                            <li>Direct printing of data grids with formatted titles and footers using the <code>DGVPrinter</code> library.</li>
                            <li>Exporting data to high-quality PDF documents using the <code>iTextSharp</code> library.</li>
                        </ul>
                    </li>
                    <li><b>Dynamic Data Lookup:</b> The student registration form uses an external API (<code>countriesnow.space</code>) to dynamically populate country and city data.</li>
                    <li><b>Dashboard Integration:</b> A link to open a Power BI dashboard file (<code>.pbix</code>) for data visualization.</li>
                </ul>
                
                <h3 id="section_2_2">2.2. System Architecture</h3>
                <p>The project employs a classic <b>3-Tier Architecture</b>, which promotes separation of concerns and maintainability.</p>
                <ol>
                    <li><b>Presentation Layer (UI):</b> Consists of all Windows Forms (<code>.cs</code> files). This layer is responsible for user interaction and data display.
                        <br><i>Files: <code>Megasoft_TMS.cs</code>, <code>Register_std_Form.cs</code>, etc.</i></li>
                    <li><b>Business & Data Access Layer (BLL/DAL):</b> A set of C# classes that encapsulate business logic and database interactions. It acts as the bridge between the UI and the database.
                        <br><i>Files: <code>StudentClass.cs</code>, <code>CourseClass.cs</code>, <code>DB_connection.cs</code>.</i></li>
                    <li><b>Data Layer (Database):</b> A Microsoft SQL Server database named <code>megasoft</code> serves as the central repository for all application data.</li>
                </ol>
                
                <h3 id="section_2_3">2.3. Technology Stack</h3>
                <table>
                    <tr><th>Category</th><th>Technology</th></tr>
                    <tr><td>Primary Language</td><td>C#</td></tr>
                    <tr><td>Framework</td><td>.NET Framework 4.7.2</td></tr>
                    <tr><td>User Interface</td><td>Windows Forms (WinForms)</td></tr>
                    <tr><td>Database</td><td>Microsoft SQL Server</td></tr>
                    <tr><td>Key Libraries</td><td>iTextSharp, DGVPrinter, Newtonsoft.Json</td></tr>
                </table>
            </section>

            <section id="section_3">
                <h2>3. Installation & Setup Guide</h2>
                <h3 id="section_3_1">3.1. Prerequisites</h3>
                <ul>
                    <li>Windows Operating System (7, 8, 10, 11)</li>
                    <li>Microsoft Visual Studio 2017 or later</li>
                    <li>.NET Framework 4.7.2</li>
                    <li>Microsoft SQL Server (2014 or later) with SQL Server Management Studio (SSMS)</li>
                </ul>
                <h3 id="section_3_2">3.2. Database Setup</h3>
                <ol>
                    <li>Open <b>SQL Server Management Studio (SSMS)</b> and connect to your local database engine.</li>
                    <li>In the Object Explorer, right-click on "Databases" and select "New Database...".</li>
                    <li>Enter the database name as <code>megasoft</code> and click OK.</li>
                    <li>Select the new database, click "New Query", and execute the SQL scripts from <b>Section 6.2</b> of this document.</li>
                </ol>
                <h3 id="section_3_3">3.3. Application Configuration</h3>
                <p>Ensure the database connection string is correctly configured.</p>
                <ol>
                    <li>Open the file <code>DB_connection.cs</code>.</li>
                    <li>Locate this line:
<pre><code>conn = new SqlConnection("Data Source=DESKTOP-7TQNV83\\MSSQLSERVER01;Initial Catalog=megasoft;Integrated Security=True;");</code></pre>
                    </li>
                    <li>Change the <code>Data Source</code> value to match your SQL Server instance name.</li>
                </ol>
                <h3 id="section_3_4">3.4. Building and Running</h3>
                <ol>
                    <li>Open the <code>TMS_MegaSoft_Project.sln</code> file in Visual Studio.</li>
                    <li>Right-click the solution in the Solution Explorer and select <b>"Restore NuGet Packages"</b>.</li>
                    <li>Press <b>F5</b> or click the "Start" button to run the application.</li>
                </ol>
            </section>
            
            <section id="section_5">
                <h2>5. Code Documentation (Developer Guide)</h2>
                <h3 id="section_5_1">5.1. Project File Structure</h3>
                <p>The project is organized into several C# files, each with a distinct responsibility, following the 3-Tier Architecture.</p>

                <h3 id="section_5_2">5.2. Core Components Analysis</h3>
                <ul>
                    <li><b><code>Program.cs</code>:</b> The main entry point. [cite_start]It initializes the application and launches the <code>SplashForm</code>[cite: 2, 3, 4].</li>
                    [cite_start]<li><b><code>SplashForm.cs</code>:</b> A loading screen that uses a <code>Timer</code> object to increment a progress bar[cite: 7, 8, 9, 12]. [cite_start]Once complete, it hides itself and opens the <code>LoginForm</code>[cite: 13, 14].</li>
                    <li><b><code>DB_connection.cs</code>:</b> Centralizes database connection logic. [cite_start]It creates a <code>SqlConnection</code> object and provides methods to open and close the connection[cite: 15, 16, 18, 19, 20].</li>
                    <li><b>Data Access Classes (e.g., <code>StudentClass.cs</code>):</b> These classes encapsulate all SQL queries. [cite_start]They use parameterized queries to prevent SQL injection[cite: 23, 24, 30, 34].</li>
                    <li><b>Helper Classes:</b>
                        <ul>
                            [cite_start]<li><b><code>CountryModels.cs</code>:</b> Contains C# classes used by <code>Newtonsoft.Json</code> to deserialize the JSON response from the countries API[cite: 526, 527, 528, 529, 530, 531, 532, 533].</li>
                            [cite_start]<li><b><code>DGVPrinter.cs</code>:</b> A third-party helper class that provides extensive functionality to format and print `DataGridView` controls[cite: 661].</li>
                        </ul>
                    </li>
                </ul>

                <h3 id="section_5_3">5.3. UI Forms Analysis</h3>
                <ul>
                    <li><b><code>Megasoft_TMS.cs</code> (Main Form):</b> Acts as the central navigation hub. [cite_start]Uses <code>Panel</code> controls as sub-menus, which are shown and hidden via helper functions[cite: 42, 47, 51]. [cite_start]Contains methods like <code>SwitchTo_Register_std_Form()</code> to navigate between forms[cite: 89].</li>
                    [cite_start]<li><b><code>Register_std_Form.cs</code>:</b> On form load, it asynchronously calls `LoadCountriesAsync()` to fetch country data from an API[cite: 99, 100]. [cite_start]The `verify()` method performs client-side validation[cite: 112]. [cite_start]The `Upload_btn_Click` event handler uses an <code>OpenFileDialog</code> for image selection[cite: 139].</li>
                    [cite_start]<li><b><code>Edit_std_form.cs</code>:</b> Loads all student data into a `DataGridView`[cite: 183, 184]. [cite_start]The `dataGridView_table_Click` event populates input fields from the selected row[cite: 190, 191]. [cite_start]Implements search, update, and delete functionalities[cite: 203, 222, 253].</li>
                    [cite_start]<li><b>Reporting Forms (e.g., <code>Print.cs</code>):</b> These forms provide UI elements for filtering data[cite: 292, 294]. [cite_start]They use a <code>DGVPrinter</code> object to print tables [cite: 309] [cite_start]and the <code>iTextSharp</code> library to create and save PDF documents[cite: 313, 502].</li>
                </ul>
            </section>

            <section id="section_6">
                <h2>6. Database Schema</h2>
                <h3 id="section_6_1">6.1. Entity-Relationship Diagram (ERD)</h3>
                <div class="note">
                    <img src= "D:\MegaSoft\Schemas\ERD_New.png" style="width: 100%; height: auto;">
                </div>
                
                <h3 id="section_6_2">6.2. SQL Table Creation Scripts</h3>
                <p>Execute these scripts in SSMS on the <code>megasoft</code> database.</p>
                
                <h4>Users Table</h4>
<pre><code>CREATE TABLE Users (
    id INT PRIMARY KEY IDENTITY(1,1),
    username NVARCHAR(50) NOT NULL,
    password NVARCHAR(50) NOT NULL
);
GO</code></pre>

                <h4>Courses Table</h4>
<pre><code>CREATE TABLE Courses (
    id INT PRIMARY KEY IDENTITY(1,1),
    course_name NVARCHAR(50) NOT NULL,
    description NVARCHAR(200),
    instructor_name NVARCHAR(50),
    hours INT
);
GO</code></pre>

                <h4>Students Table</h4>
<pre><code>CREATE TABLE Students (
    id INT PRIMARY KEY IDENTITY(1,1),
    first_name NVARCHAR(100) NOT NULL,
    last_name NVARCHAR(200) NOT NULL,
    dob DATE NOT NULL,
    role NVARCHAR(200),
    phone_no NVARCHAR(200),
    gender NVARCHAR(50),
    country NVARCHAR(200),
    city NVARCHAR(200),
    postal_code INT,
    address NVARCHAR(200),
    img VARBINARY(MAX)
);
GO</code></pre>

                <h4>Scores Table</h4>
<pre><code>CREATE TABLE Scores (
    id INT PRIMARY KEY IDENTITY(1,1),
    student_id INT NOT NULL,
    course_id INT NOT NULL,
    score INT,
    status NVARCHAR(50),
    CONSTRAINT FK_Scores_Students FOREIGN KEY (student_id) REFERENCES Students(id) ON DELETE CASCADE,
    CONSTRAINT FK_Scores_Courses FOREIGN KEY (course_id) REFERENCES Courses(id) ON DELETE CASCADE
);
GO</code></pre>
            </section>

            <section id="section_7">
                <h2>7. Appendices</h2>
                <h3 id="section_7_1">7.1. External Dependencies & APIs</h3>
                <ul>
                    <li><b>NuGet Packages:</b> <code>iTextSharp</code>, <code>Newtonsoft.Json</code>.</li>
                    <li><b>Helper Class:</b> <code>DGVPrinter.cs</code>.</li>
                    <li><b>External API:</b> Countries & Cities API at <code>https://countriesnow.space/api/v0.1/</code>.</li>
                </ul>
                <h3 id="section_7_2">7.2. Troubleshooting</h3>
                <ul>
                    <li><b>Database Connection Error:</b> Ensure SQL Server service is running and the connection string in <code>DB_connection.cs</code> is correct.</li>
                    <li><b>API Failure:</b> Check your internet connection if the application fails to load country/city data.</li>
                </ul>
            </section>
        </main>
    </div>
</body>
</html>